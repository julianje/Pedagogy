---
title: "Pedagogy model"
output:
  html_document:
    theme: spacelab
    toc: yes
  pdf_document:
    toc: yes
---

```{r Load data and packages, echo=FALSE}
library(dplyr, quietly=T, warn.conflicts=F)
library(ggplot2, quietly=T, warn.conflicts=F)
library(ggvis, quietly=T, warn.conflicts=F)
library(tidyr, quietly=T, warn.conflicts=F)
library(knitr, quietly=T, warn.conflicts=F)
library(boot, quietly=T, warn.conflicts=F)
setwd("~/Documents/Projects/Models/Pedagogy/Pedagogy/")
data <- read.csv("ModelPredictions.csv") %>% tbl_df %>% mutate(Model=paste(LearnC,LearnR,TeachC,TeachR,DiscoverC,DiscoverR))
levels(data$Condition)=c("1: Equal\nCosts","4: Inverted\nRewards","3: Matched\nRewards","2: Unequal\nCosts")
data$Condition<-as.character(data$Condition)
data$ExploreProb<-factor(data$ExploreProb)
levels(data$ExploreProb)=c("Exploration\nuncertainty","Exploration\ncertainty")
levels(data$TeacherReward)=c("Constant\nteacher reward","Variable\nteacher reward")
levels(data$Decision)=c("2: Either","3: Red toy","1: Yellow toy")
data$Decision<-as.character(data$Decision)
Summarydata<-data %>%
dplyr::group_by(ExploreProb,TeacherReward,Condition,Decision,Model) %>%
dplyr::summarise(proportion=n())
```

# Main models

## Model 00_00_00

Ignore learner's utility with taught toy.

Ignore learner's utility with untaught toy.

```{r Plot_000000, echo=FALSE, fig.width = 10, fig.height = 5}
Summarydata %>%
  filter(Model=="0 0 0 0 0 0") %>%
  ggplot(aes(x=Condition,y=proportion,fill=Decision))+geom_bar(color="black",stat="identity")+facet_grid(ExploreProb~TeacherReward)+
  theme_bw()+scale_fill_manual(values=c("#00B554"))
```

## Model 00_00_11

Ignore learner's utility with taught toy.

Use learner's utility with untaught toy.

```{r Plot_000011, echo=FALSE, fig.width = 10, fig.height = 5}
Summarydata %>%
  filter(Model=="0 0 0 0 1 1") %>%
  ggplot(aes(x=Condition,y=proportion,fill=Decision))+geom_bar(color="black",stat="identity")+facet_grid(ExploreProb~TeacherReward)+
  theme_bw()+scale_fill_manual(values=c("#EBE549","#00B554","#C7363D"))
```

## Model 11_00_00

Use learner's utility with taught toy.

Ignore learner's utility with untaught toy.

```{r Plot_110000, echo=FALSE, fig.width = 10, fig.height = 5}
Summarydata %>%
  filter(Model=="1 1 0 0 0 0") %>%
  ggplot(aes(x=Condition,y=proportion,fill=Decision))+geom_bar(color="black",stat="identity")+facet_grid(ExploreProb~TeacherReward)+
  theme_bw()+scale_fill_manual(values=c("#EBE549","#00B554","#C7363D"))
```

## Model 11_00_11

Use learner's utility with taught toy.

Ignore learner's utility with untaught toy.

```{r Plot_110011, echo=FALSE, fig.width = 10, fig.height = 5}
Summarydata %>%
  filter(Model=="1 1 0 0 1 1") %>%
  ggplot(aes(x=Condition,y=proportion,fill=Decision))+geom_bar(color="black",stat="identity")+facet_grid(ExploreProb~TeacherReward)+
  theme_bw()+scale_fill_manual(values=c("#EBE549","#00B554","#C7363D"))
```

# Cost-Reward exploration

## Model 01_00_01

Use rewards only

```{r Plot_010001, echo=FALSE, fig.width = 10, fig.height = 5}
Summarydata %>%
  filter(Model=="0 1 0 0 0 1") %>%
  ggplot(aes(x=Condition,y=proportion,fill=Decision))+geom_bar(color="black",stat="identity")+facet_grid(ExploreProb~TeacherReward)+
  theme_bw()+scale_fill_manual(values=c("#EBE549","#00B554","#C7363D"))
```

## Model 10_00_10

Use costs only

```{r Plot_100010, echo=FALSE, fig.width = 10, fig.height = 5}
Summarydata %>%
  filter(Model=="1 0 0 0 1 0") %>%
  ggplot(aes(x=Condition,y=proportion,fill=Decision))+geom_bar(color="black",stat="identity")+facet_grid(ExploreProb~TeacherReward)+
  theme_bw()+scale_fill_manual(values=c("#EBE549","#00B554"))
```

# Teacher exploration

## Model 10_10_10

Use everyone's costs

```{r Plot_101010, echo=FALSE, fig.width = 10, fig.height = 5}
Summarydata %>%
  filter(Model=="1 0 1 0 1 0") %>%
  ggplot(aes(x=Condition,y=proportion,fill=Decision))+geom_bar(color="black",stat="identity")+facet_grid(ExploreProb~TeacherReward)+
  theme_bw()+scale_fill_manual(values=c("#EBE549","#00B554","#C7363D"))
```

## Model 11_10_11

Everything about learner, and teacher's costs

```{r Plot_111011, echo=FALSE, fig.width = 10, fig.height = 5}
Summarydata %>%
  filter(Model=="1 1 1 0 1 1") %>%
  ggplot(aes(x=Condition,y=proportion,fill=Decision))+geom_bar(color="black",stat="identity")+facet_grid(ExploreProb~TeacherReward)+
  theme_bw()+scale_fill_manual(values=c("#EBE549","#00B554","#C7363D"))
```

## Model 11_01_11

Everything about learner, and teacher's rewards

```{r Plot_110111, echo=FALSE, fig.width = 10, fig.height = 5}
Summarydata %>%
  filter(Model=="1 1 0 1 1 1") %>%
  ggplot(aes(x=Condition,y=proportion,fill=Decision))+geom_bar(color="black",stat="identity")+facet_grid(ExploreProb~TeacherReward)+
  theme_bw()+scale_fill_manual(values=c("#EBE549","#00B554","#C7363D"))
```

## Model 11_11_11

Everything about everything

```{r Plot_111111, echo=FALSE, fig.width = 10, fig.height = 5}
Summarydata %>%
  filter(Model=="1 1 1 1 1 1") %>%
  ggplot(aes(x=Condition,y=proportion,fill=Decision))+geom_bar(color="black",stat="identity")+facet_grid(ExploreProb~TeacherReward)+
  theme_bw()+scale_fill_manual(values=c("#EBE549","#00B554","#C7363D"))
```
